<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper     PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"     "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ch4.mybatis.mapper.GoodsMapper">
	<!-- QR코드 조회(goods) -->
	<select id="goodsQRcode" parameterType="map" resultType="map">
		select confm_no, confm_name, confm_type, confm_quan
				,confm_qrcode, aplg_trans_date, com_name
		  from goods_confm gc, goods_apply ga, company co
		 where ga.aplg_no = gc.aplg_no
		   and co.com_no = ga.com_no
		   and gc.aplg_no = #{aplg_no}
	</select>
	<!-- 반입 신청 등록 -->
    <insert id="goodsApplyAdd" parameterType="map">
		insert into goods_apply(aplg_no, aplg_name, aplg_reason
				,aplg_desti, aplg_trans_date, aplg_hp, com_no)
		values(#{aplg_no}, #{aplg_name}, #{aplg_reason}
				,#{aplg_desti}, #{aplg_trans_date}, #{aplg_hp}, #{com_no})
    </insert>
    <!-- 반입 물품정보 등록 -->
    <insert id="goodsAdd" parameterType="map">
		insert into goods_mng(aplg_no, gmng_name, gmng_type, gmng_quan)
		values(#{aplg_no}, #{gmng_name}, #{gmng_type}, #{gmng_quan})
    </insert>
	<!-- 반입 신청 변경 -->
	<update id="goodsApplyUpdate" parameterType="map">
		update goods_apply
           set aplg_reason = #{aplg_reason}
              ,aplg_desti = #{aplg_desti}
              ,aplg_trans_date = #{aplg_trans_date}
         where aplg_no = #{aplg_no}
	</update>
	<!-- 반입 신청 변경(물품관리 삭제) -->
	<update id="goodsSubDelete" parameterType="map">
		delete from goods_mng
		 where aplg_no = #{aplg_no}
	</update>
	<!-- 반입 신청 취소 (결제상태 변경)-->
	<update id="goodsApplyCancle" parameterType="map" statementType="CALLABLE">
		{call proc_goodsCancle(#{aplg_no, mode=IN, jdbcType=VARCHAR, javaType=java.lang.String})}
	</update>
</mapper>